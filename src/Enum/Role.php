<?php

declare(strict_types=1);

namespace App\Enum;

enum Role: string
{
    case Wife = 'wife';
    case Sister = 'sister';
    case Teammate = 'teammate';

    public function label(): string
    {
        return match ($this) {
            self::Wife => 'ðŸ’ Ð–ÐµÐ½Ð°',
            self::Sister => 'âœ¨ Ð¡ÐµÑÑ‚Ñ€Ð°',
            self::Teammate => 'ðŸ¤ Ð¢Ð¸Ð¼Ð¼ÐµÐ¹Ñ‚',
        };
    }

    public function emoji(): string
    {
        return match ($this) {
            self::Wife => 'ðŸ’',
            self::Sister => 'âœ¨',
            self::Teammate => 'ðŸ¤',
        };
    }

    public function buildPrompt(?string $name, array $previousCompliments = []): string
    {
        $namePhrase = $name ? " Ð´Ð»Ñ {$name}" : '';

        $prompt = match ($this) {
            self::Wife => <<<PROMPT
                ÐÐ°Ð¿Ð¸ÑˆÐ¸ Ð¾Ð´Ð¸Ð½ ÐºÑ€Ð°ÑÐ¸Ð²Ñ‹Ð¹, Ð¸ÑÐºÑ€ÐµÐ½Ð½Ð¸Ð¹ Ð¸ Ñ€Ð¾Ð¼Ð°Ð½Ñ‚Ð¸Ñ‡Ð½Ñ‹Ð¹ ÐºÐ¾Ð¼Ð¿Ð»Ð¸Ð¼ÐµÐ½Ñ‚{$namePhrase} Ð½Ð° Ñ€ÑƒÑÑÐºÐ¾Ð¼ ÑÐ·Ñ‹ÐºÐµ.

                Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ:
                - ÐšÐ¾Ð¼Ð¿Ð»Ð¸Ð¼ÐµÐ½Ñ‚ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ñ‚ÑŒ Ñ‚Ñ‘Ð¿Ð»Ñ‹Ð¼ Ð¸ Ð½ÐµÐ¶Ð½Ñ‹Ð¼
                - ÐÐµ Ð±Ð¾Ð»ÐµÐµ 2-3 Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¹
                - Ð‘ÐµÐ· ÐºÐ°Ð²Ñ‹Ñ‡ÐµÐº Ð¸ Ð¿Ñ€ÐµÑ„Ð¸ÐºÑÐ¾Ð² Ñ‚Ð¸Ð¿Ð° "ÐšÐ¾Ð¼Ð¿Ð»Ð¸Ð¼ÐµÐ½Ñ‚:"
                - ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ñ‚ÐµÐºÑÑ‚ ÐºÐ¾Ð¼Ð¿Ð»Ð¸Ð¼ÐµÐ½Ñ‚Ð°

                ÐÐ°Ð¿Ð¸ÑˆÐ¸ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐºÐ¾Ð¼Ð¿Ð»Ð¸Ð¼ÐµÐ½Ñ‚, Ð±ÐµÐ· Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¿Ð¾ÑÑÐ½ÐµÐ½Ð¸Ð¹.
                PROMPT,

            self::Sister => <<<PROMPT
                ÐÐ°Ð¿Ð¸ÑˆÐ¸ Ð¾Ð´Ð½Ð¾ Ñ‚Ñ‘Ð¿Ð»Ð¾Ðµ Ð¿Ð¾Ð´Ð±Ð°Ð´Ñ€Ð¸Ð²Ð°ÑŽÑ‰ÐµÐµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ{$namePhrase} â€” Ð´Ð»Ñ 10-Ð»ÐµÑ‚Ð½ÐµÐ¹ Ð´ÐµÐ²Ð¾Ñ‡ÐºÐ¸-ÑˆÐºÐ¾Ð»ÑŒÐ½Ð¸Ñ†Ñ‹ Ð½Ð° Ñ€ÑƒÑÑÐºÐ¾Ð¼ ÑÐ·Ñ‹ÐºÐµ.

                Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ:
                - Ð”Ñ€ÑƒÐ¶ÐµÑÐºÐ¾Ðµ Ð¸ Ð¿Ð¾Ð·Ð¸Ñ‚Ð¸Ð²Ð½Ð¾Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ
                - ÐœÐ¾Ñ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ, Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð² ÑƒÑ‡Ñ‘Ð±Ðµ Ð¸Ð»Ð¸ Ð´Ð¾Ð±Ñ€Ñ‹Ðµ ÑÐ»Ð¾Ð²Ð°
                - ÐœÐ¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ 1-2 ÑÐ¼Ð¾Ð´Ð·Ð¸ (Ð½Ð¾ Ð½Ðµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾)
                - ÐÐµ Ð±Ð¾Ð»ÐµÐµ 2 Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¹
                - Ð‘ÐµÐ· ÐºÐ°Ð²Ñ‹Ñ‡ÐµÐº Ð¸ Ð¿Ñ€ÐµÑ„Ð¸ÐºÑÐ¾Ð²
                - ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ñ‚ÐµÐºÑÑ‚ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ

                ÐÐ°Ð¿Ð¸ÑˆÐ¸ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ, Ð±ÐµÐ· Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¿Ð¾ÑÑÐ½ÐµÐ½Ð¸Ð¹.
                PROMPT,

            self::Teammate => <<<PROMPT
                ÐÐ°Ð¿Ð¸ÑˆÐ¸ Ð¾Ð´Ð½Ð¾ Ñ‚Ñ‘Ð¿Ð»Ð¾Ðµ, Ð¼Ð¾Ñ‚Ð¸Ð²Ð¸Ñ€ÑƒÑŽÑ‰ÐµÐµ Ð½Ð°Ð¿ÑƒÑ‚ÑÑ‚Ð²Ð¸Ðµ{$namePhrase} Ð¾Ñ‚ Ñ‚Ð¸Ð¼Ð»Ð¸Ð´Ð° Ð½Ð° Ñ€ÑƒÑÑÐºÐ¾Ð¼ ÑÐ·Ñ‹ÐºÐµ.

                Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ:
                - Ð¢Ð¾Ð½: Ð´Ñ€ÑƒÐ¶ÐµÐ»ÑŽÐ±Ð½Ñ‹Ð¹, Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÑŽÑ‰Ð¸Ð¹, ÐºÐ°Ðº Ð¾Ñ‚ ÑÑ‚Ð°Ñ€ÑˆÐµÐ³Ð¾ ÐºÐ¾Ð»Ð»ÐµÐ³Ð¸
                - ÐŸÐ¾Ð´Ñ…Ð¾Ð´Ð¸Ñ‚ Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²Ð¾ Ð´Ð»Ñ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¾Ð², Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ñ‰Ð¸ÐºÐ¾Ð² Ð¸ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð²
                - ÐœÐ¾Ñ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ, Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ°, Ð¿Ñ€Ð¸Ð·Ð½Ð°Ð½Ð¸Ðµ Ð²ÐºÐ»Ð°Ð´Ð° Ð² ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ
                - ÐœÐ¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ 1-2 ÑÐ¼Ð¾Ð´Ð·Ð¸ (Ð½Ð¾ Ð½Ðµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾)
                - ÐÐµ Ð±Ð¾Ð»ÐµÐµ 2-3 Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¹
                - Ð‘ÐµÐ· ÐºÐ°Ð²Ñ‹Ñ‡ÐµÐº Ð¸ Ð¿Ñ€ÐµÑ„Ð¸ÐºÑÐ¾Ð²
                - ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ñ‚ÐµÐºÑÑ‚ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ

                ÐÐ°Ð¿Ð¸ÑˆÐ¸ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ, Ð±ÐµÐ· Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¿Ð¾ÑÑÐ½ÐµÐ½Ð¸Ð¹.
                PROMPT,
        };

        if (!empty($previousCompliments)) {
            $list = '';
            foreach ($previousCompliments as $i => $text) {
                $list .= ($i + 1) . '. ' . $text . "\n";
            }

            $prompt .= <<<DEDUP

                Ð’ÐÐ–ÐÐž: ÐÐ¸Ð¶Ðµ Ð¿Ñ€Ð¸Ð²ÐµÐ´ÐµÐ½Ñ‹ Ñ€Ð°Ð½ÐµÐµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ. Ð¢Ð²Ð¾Ñ‘ Ð½Ð¾Ð²Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¼
                Ð¸ ÐÐ• Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÑ‚ÑŒ Ð½Ð¸ Ð¾Ð´Ð½Ð¾ Ð¸Ð· Ð½Ð¸Ñ… Ð¿Ð¾ ÑÐ¼Ñ‹ÑÐ»Ñƒ, ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ðµ Ð¸Ð»Ð¸ ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ð¼ Ñ„Ñ€Ð°Ð·Ð°Ð¼:
                {$list}
                DEDUP;
        }

        return $prompt;
    }
}
